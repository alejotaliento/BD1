delimiter $$
create procedure generarVehiculo(idPedidoParametro int)
BEGIN

DECLARE finished INTEGER DEFAULT 0;
DECLARE idModeloParametro INTEGER;
DECLARE nCantidadDetalle INT; 
 
DECLARE nInsertados INT;

DECLARE curDetallePedido
        CURSOR FOR
            SELECT idModelo, cantidad FROM detalle_pedido WHERE idPedido = idPedidoParametro;
  DECLARE CONTINUE HANDLER
        FOR NOT FOUND SET finished = 1;
        
        OPEN curDetallePedido;
        


-- Aca comienzo el loop recorriendo el cursor.
    getDetalle: LOOP
 
        FETCH curDetallePedido INTO idModeloParametro, nCantidadDetalle;
 
        IF finished = 1 THEN
            LEAVE getDetalle;
        END IF;
 
	SET nInsertados = 0;
 
	-- Aca loopeo para hacer N inserts.
	WHILE nInsertados < nCantidadDetalle DO
 
	INSERT INTO Vehiculo (idVehiculo,numeroChasis, eliminado, detalle_pedido_idPedido, detalle_pedido_idModelo)VALUES (getRandom(),lpad(conv(floor(rand()*pow(36,6)), 10, 36), 6, 0),0,idPedidoParametro, idModeloParametro);
    
    
 
SET nInsertados = nInsertados  +1;
 
	END WHILE;
 
    END LOOP getDetalle;
 
-- Elimino el cursor de memoria
 
    CLOSE curDetallePedido;

END $$